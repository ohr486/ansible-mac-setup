---
- lineinfile: dest=~/.bash_profile line='# for pyenv by ansible-mac-setup'
- lineinfile: dest=~/.bash_profile line='export PYENV_ROOT="$HOME/.pyenv"'
- lineinfile: dest=~/.bash_profile line='export PATH="$PYENV_ROOT/bin:$PATH"'
- lineinfile: dest=~/.bash_profile line='export PYENV_VIRTUALENVWRAPPER_PREFER_PYVENV="true"'
- lineinfile: dest=~/.bash_profile line='export WORKON_HOME=~/.virtualenvs'

- name: install latest python
  shell: pyenv install $(pyenv install -l | grep -v - | tail -1)

- name: rehash
  shell: pyenv rehash

- name: set latest python
  shell: pyenv global $(pyenv install -l | grep -v - | tail -1)

- name: create virtualenvs dir
  file: path=~/.virtualenvs state=directory

- name: install pip mods for virtualenv
  pip:
    name:
      - virtualenv
      - virtualenvwrapper

- lineinfile: dest=~/.bash_profile line='eval "$(pyenv init -)"'
- lineinfile: dest=~/.bash_profile line='if which pyenv-virtualenv-init > /dev/null; then eval "$(pyenv virtualenv-init -)"; fi'
- lineinfile: dest=~/.bash_profile line='pyenv virtualenvwrapper_lazy'

- name: source ~/.bash_profile
  shell: source ~/.bash_profile
